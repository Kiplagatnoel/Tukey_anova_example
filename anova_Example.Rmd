---
title: "Anova, PCA, Factor Loadings, Kmeans, Hierrachical clustering and Correlation"
author: "Kiplagat John Noel"
output:
  word_document: default
date: "`r Sys.Date()`"
---


```{r, echo = FALSE}
suppressPackageStartupMessages({
library(ggplot2)
library(reshape2)
library(psych)
library(ggplot2)
library(rstatix)
library(factoextra)
library(phangorn)
library(ggtree)
library(pheatmap)
library(Hmisc)
library(magrittr)
library(stringr)
library(multcompView)
library(multcomp)
library(emmeans)
library(corrplot)
library(tidyr)
library(cowplot) 
library(RColorBrewer)
library(dplyr)
library(lsmeans)
})

```


```{r, echo = FALSE}
df<-read.csv("R_analysis_data.csv")
df$Light <- factor(as.character(df$Light), levels=c("Blue", "Combination", "Red", "White"))
df$Media <- factor(as.character(df$Media), levels=c("Cocopeat", "Cocopeat+Sand", "Sand"))       
df$Rep <- factor(as.character(df$Rep), levels=c("1", "2", "3"))
```

```{r, echo = FALSE}
num_cols <- names(df[,4:16])
fac_cols <- names(df[,1:3])
numdf <- df[,num_cols]
```



```{r, echo = FALSE}
indep_var_list <- list(c("Light"))

dep_vars <- c("Vit_C", "Flavonoid", "Phenols", "Nitrate", "Carotenoid", "Chlorophyll_A", "Chlorophyll_B", "Total_Chlorophyll", "Leaf_area", "Plant_Height","Perc_Canopy_Cover", "Yield" ,"Dry_Weight"
)

plist <- Map(function(x, y) {
    plist <- list()
    fmla <-  as.formula(paste(y, "~ ", x))
    p <- plot(fmla, data = df, col = 2:5,main=paste(y,"under different Light conditions"))
    plist[] <- p
    plist
}, indep_var_list, dep_vars)
```


```{r, echo = FALSE}
indep_var_list <- list(c("Media"))

dep_vars <- c("Vit_C", "Flavonoid", "Phenols", "Nitrate", "Carotenoid", "Chlorophyll_A", "Chlorophyll_B", "Total_Chlorophyll", "Leaf_area", "Plant_Height","Perc_Canopy_Cover", "Yield" ,"Dry_Weight"
)

plist <- Map(function(x, y) {
    plist <- list()
    fmla <-  as.formula(paste(y, "~ ", x))
    p <- plot(fmla, data = df, col = 2:5,main=paste(y,"under different Media conditions"))
    plist[] <- p
    plist
}, indep_var_list, dep_vars)
```


Before running any tests, we should first look at the data. We will create **interaction plots**, which will help us visualize the effect of one factor, as we move through the levels of another factor.

If there is not interaction, thus an additive model, we would expect to see parallel lines. That would mean, when we change the level of one factor, there can be an effect on the response. However, the difference between the levels of the other factor should still be the same.

The obvious indication of interaction would be lines that cross while heading in different directions. Here we don't see that, but the lines aren't strictly parallel, and there is some overlap on the right panel. However, is this interaction effect significant?



```{r, echo = FALSE}
d2 <- melt(df,id.vars = fac_cols, value.name = "Conc")
names(d2)[4] <- "Element"
int_Media <- ggplot(d2, aes(x=Media, y=Conc, group=interaction(Element,Light), color=Element))+
           stat_summary(fun=mean, geom="line",linewidth=1)
int_Media
```

The mean concentration of various elements were higher under combination of blue light followed by the combination of Cocopeat + Sand and red light.

Highest concentrations are recorded for the combination of; blue light and sand followed by red light and cocopeat+sand. Concentrations were low in the combination of blue light and cocopeat.

The highest leaf area in observed plants was recorded when sand was used as media while the highest Vitamin C was recorded for Cocopeat. Likewise, higher concentrations of chlorophyl B was highest in Cocopeat+Sand while Nitrate was highest in Cocopeat. Caretinoid were high in Sand. 

```{r, fig.height = 7, fig.width = 10, echo = FALSE}
int_plot1 <- with(d2,  interaction.plot(Media,Light,Conc,col=1:4, lwd=3))
int_plot1
```



```{r , fig.height = 7, fig.width = 10, echo = FALSE}
int_plot2 <- with(d2,  interaction.plot(Light,Media,Conc,col=1:3, lwd=3))
int_plot2
```


## Additive Anova

The row for **AB Interaction** tests:
  
  \[
    H_0: \text{ All }(\alpha\beta)_{ij} = 0. \quad \text{vs} \quad H_1: \text{ Not all } (\alpha\beta)_{ij} \text{ are } 0.
    \]

- Null Model: $y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}.$ (Additive Model.)
- Alternative Model: $y_{ijk} = \mu + \alpha_i + \beta_j + (\alpha \beta)_{ij} + \epsilon_{ijk}.$ (Interaction Model.)

We reject the null when the $F$ statistic is large. Under the null hypothesis, the distribution of the test statistic is $F$ with degrees of freedom $(I -1)(J -1)$ and $IJ(K - 1)$.

The row for **Factor B** tests:
  
  \[
    H_0: \text{ All }\beta_{j} = 0. \quad \text{vs} \quad H_1: \text{ Not all } \beta_{j} \text{ are } 0.
    \]

- Null Model: $y_{ijk} = \mu + \alpha_i + \epsilon_{ijk}.$ (Only Factor A Model.)
- Alternative Model: $y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}.$ (Additive Model.)

We reject the null when the $F$ statistic is large. Under the null hypothesis, the distribution of the test statistic is $F$ with degrees of freedom $J - 1$ and $IJ(K - 1)$.

The row for **Factor A** tests:
  
  \[
    H_0: \text{ All }\alpha_{i} = 0. \quad \text{vs} \quad H_1: \text{ Not all } \alpha_{i} \text{ are } 0.
    \]

- Null Model: $y_{ijk} = \mu + \beta_j + \epsilon_{ijk}.$ (Only Factor B Model.)
- Alternative Model: $y_{ijk} = \mu + \alpha_i + \beta_j + \epsilon_{ijk}.$ (Additive Model.)

We reject the null when the $F$ statistic is large. Under the null hypothesis, the distribution of the test statistic is $F$ with degrees of freedom $I - 1$ and $IJ(K - 1)$.

These tests should be performed according to the model **hierarchy**. First consider the test of interaction. If it is significant, we select the interaction model and perform no further testing. If interaction is not significant, we then consider the necessity of the individual factors of the additive model.

```{r, echo = FALSE}
#suppressWarnings(expr, classes = "warning")

indep_var_list <- list(c("Light", "Media", "Rep"),c("Light", "Media", "Rep"),c("Light", "Media", "Rep"),c("Light", "Media", "Rep"))

dep_vars <- c("Vit_C", "Flavonoid", "Phenols", "Nitrate", "Carotenoid", "Chlorophyll_A", "Chlorophyll_B", "Total_Chlorophyll", "Leaf_area", "Plant_Height","Perc_Canopy_Cover", "Yield" ,"Dry_Weight"
)

suppressWarnings(out <- Map(function(x, y) {
    
    fmla <-  as.formula(paste(y, "~ ", paste(x, collapse= " + ")))
    model <- aov(fmla, data = df)
    model
}, indep_var_list, dep_vars), classes = "warning")
```


Light had a significant effect on Vitamin C concentrations (p=0.003488) at p<0.01.

```{r, echo = FALSE}
knitr::kable(anova(out[[1]]))
```

Media had a significant effect on Flavonoid concentrations (p=0.02525) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out[[2]]))
```

Media had a significant effect on Phenols concentrations (p=0.02486) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out[[3]]))
```

Light had a significant effect on Nitrate concentrations (p=0.00052) at p<0.001.

```{r, echo = FALSE}
knitr::kable(anova(out[[4]]))
```

Light had a significant effect on Caretinoid concentrations (p=0.0361) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out[[5]]))
```

Media had a significant effect on Chlorophyl A concentrations (p=2.34e-06) at p<0.001.

```{r, echo = FALSE}
knitr::kable(anova(out[[6]]))
```

Combination of Light and Media had a significant effect on Chlorophyl B concentrations (p=0.0009425 and p=1.453e-07) at p<0.001.

```{r, echo = FALSE}
knitr::kable(anova(out[[7]]))
```

Combination of Light and Media had a significant effect on Total Chlorophyl concentrations (p=0.013679 and p=0.0004012) at p<0.05 and p<0.001 respectively.

```{r, echo = FALSE}
knitr::kable(anova(out[[8]]))
```
Media had a significant effect on Leaf area (p=0.02424) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out[[9]]))
```

Media had little significant effect on Plant height (p=0.02424) at p<0.1.

```{r, echo = FALSE}
knitr::kable(anova(out[[10]]))
```


## Interaction Anova

```{r, echo = FALSE}
indep_var_list <- list(c("Light", "Media"),c("Light", "Media"),c("Light", "Media"),c("Light", "Media"))

dep_vars <- c("Vit_C", "Flavonoid", "Phenols", "Nitrate", "Carotenoid", "Chlorophyll_A", "Chlorophyll_B", "Total_Chlorophyll", "Leaf_area", "Plant_Height","Perc_Canopy_Cover", "Yield" ,"Dry_Weight"
)

suppressWarnings(out1 <- Map(function(x, y) {
    
    fmla <-  as.formula(paste(y, "~ ", paste(x, collapse= "+"), "+", paste(x, collapse= "*")))
    model <- aov(fmla, data = df)
    model
}, indep_var_list, dep_vars),classes = "warning")
```


Light had a significant effect on Vitamin C concentrations (p=0.003488) at p<0.01.

```{r, echo = FALSE}
knitr::kable(anova(out1[[1]]))
```


```{r}
marginal = emmeans(out1[[1]],~ Light:Media)
pr1 <- pairs(marginal,adjust="tukey")
knitr::kable(pr1)
```

Media had a significant effect on Flavonoid concentrations (p=0.02525) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out1[[2]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[2]],~ Light:Media)
pr2 <- pairs(marginal,adjust="tukey")
knitr::kable(pr2)
```

Media had a significant effect on Phenols concentrations (p=0.02486) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out1[[3]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[3]],~ Light:Media)
pr3 <- pairs(marginal,adjust="tukey")
knitr::kable(pr3)
```

Light had a significant effect on Nitrate concentrations (p=0.00052) at p<0.001.

```{r, echo = FALSE}
knitr::kable(anova(out1[[4]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[4]],~ Light:Media)
pr4 <- pairs(marginal,adjust="tukey")
knitr::kable(pr4)
```

Light had a significant effect on Caretinoid concentrations (p=0.0361) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out1[[5]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[5]],~ Light:Media)
pr5 <- pairs(marginal,adjust="tukey")
knitr::kable(pr5)
```

Media had a significant effect on Chlorophyl A concentrations (p=2.34e-06) at p<0.001.

```{r, echo = FALSE}
knitr::kable(anova(out1[[6]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[6]],~ Light:Media)
pr6 <- pairs(marginal,adjust="tukey")
knitr::kable(pr6)
```

Combination of Light and Media had a significant effect on Chlorophyl B concentrations (p=0.0009425 and p=1.453e-07) at p<0.001.

```{r, echo = FALSE}
knitr::kable(anova(out1[[7]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[7]],~ Light:Media)
pr7 <- pairs(marginal,adjust="tukey")
knitr::kable(pr7)
```

Combination of Light and Media had a significant effect on Total Chlorophyl concentrations (p=0.013679 and p=0.0004012) at p<0.05 and p<0.001 respectively.

```{r, echo = FALSE}
knitr::kable(anova(out1[[8]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[8]],~ Light:Media)
pr8 <- pairs(marginal,adjust="tukey")
knitr::kable(pr8)
```


Media had a significant effect on Leaf area (p=0.02424) at p<0.05.

```{r, echo = FALSE}
knitr::kable(anova(out1[[9]]))
```



```{r, echo = FALSE}
marginal = emmeans(out1[[9]],~ Light:Media)
pr9 <- pairs(marginal,adjust="tukey")
knitr::kable(pr9)
```

Media had little significant effect on Plant height (p=0.02424) at p<0.1.

```{r, echo = FALSE}
knitr::kable(anova(out1[[10]]))
```



```{r, echo = FALSE}
marginal = emmeans(out1[[10]],~ Light:Media)
pr10<- pairs(marginal,adjust="tukey")
knitr::kable(pr10)
```



```{r, echo = FALSE}
knitr::kable(anova(out1[[11]]))
```



```{r, echo = FALSE}
marginal = emmeans(out1[[11]],~ Light:Media)
pr11 <- pairs(marginal,adjust="tukey")
knitr::kable(pr11)
```



```{r, echo = FALSE}
knitr::kable(anova(out1[[12]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[12]],~ Light:Media)
pr12 <- pairs(marginal,adjust="tukey")
knitr::kable(pr12)
```



```{r, echo = FALSE}
knitr::kable(anova(out1[[13]]))
```


```{r, echo = FALSE}
marginal = emmeans(out1[[13]],~ Light:Media)
pr13 <- pairs(marginal,adjust="tukey")
knitr::kable(pr13)
```





## Tukey Honest Significant differences for Interraction between  Light and Media

```{r, echo = FALSE}
# Tukey's test
tukey_v <- TukeyHSD(out1[[1]], conf.level=0.95)

# compact letter display
cld_v <- multcompLetters4(out1[[1]], tukey_v)

# table with factors and 3rd quantile

dt_v <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Vit_C), sd = sd(Vit_C)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df1 <- data.frame(letters = cld_v$`Light:Media`$Letters)
dt_v$cld_v1 <- cld_df1$letters

#print(dt_v)

p_vit <- ggplot(dt_v, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Vitamin_C concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Vitamin_C concentration") +
  geom_text(aes(label = cld_v1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_vit
```



```{r, echo = FALSE}
# Tukey's test
tukey_f <- TukeyHSD(out1[[2]], conf.level=0.95)

# compact letter display
cld_f <- multcompLetters4(out1[[2]], tukey_f)

# table with factors and 3rd quantile

dt_f <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Flavonoid), sd = sd(Flavonoid)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df2 <- data.frame(letters = cld_f$`Light:Media`$Letters)
dt_f$cld_f1 <- cld_df2$letters

#print(dt_f)

p_flav <- ggplot(dt_f, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Flavonoid concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Flavonoid concentration") +
  geom_text(aes(label = cld_f1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_flav
```



```{r, echo = FALSE}
# Tukey's test
tukey_ph <- TukeyHSD(out1[[3]], conf.level=0.95)

# compact letter display
cld_ph <- multcompLetters4(out1[[3]], tukey_ph)

# table with factors and 3rd quantile

dt_ph <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Phenols), sd = sd(Phenols)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df3 <- data.frame(letters = cld_ph$`Light:Media`$Letters)
dt_ph$cld_ph1 <- cld_df3$letters

#print(dt_ph)

p_ph <- ggplot(dt_ph, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Phenols concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Phenol concentration") +
  geom_text(aes(label = cld_ph1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_ph
```



```{r, echo = FALSE}
# Tukey's test
tukey_nt <- TukeyHSD(out1[[4]], conf.level=0.95)

# compact letter display
cld_nt <- multcompLetters4(out1[[4]], tukey_nt)

# table with factors and 3rd quantile

dt_nt <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Nitrate), sd = sd(Nitrate)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df4 <- data.frame(letters = cld_nt$`Light:Media`$Letters)
dt_nt$cld_nt1 <- cld_df4$letters

#print(dt_nt)

p_nt <- ggplot(dt_nt, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Nitrate concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Nitrate concentration") +
  geom_text(aes(label = cld_nt1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_nt
```

```{r, echo = FALSE}
# Tukey's test
tukey_crt <- TukeyHSD(out1[[5]], conf.level=0.95)

# compact letter display
cld_crt <- multcompLetters4(out1[[5]], tukey_crt)

# table with factors and 3rd quantile

dt_crt <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Carotenoid), sd = sd(Carotenoid)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df5 <- data.frame(letters = cld_crt$`Light:Media`$Letters)
dt_crt$cld_crt1 <- cld_df5$letters

#print(dt_crt)

p_crt <- ggplot(dt_crt, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Carotenoid concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Carotenoid concentration") +
  geom_text(aes(label = cld_crt1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_crt
```





```{r, echo = FALSE}
# Tukey's test
tukey_chlor_A <- TukeyHSD(out1[[6]], conf.level=0.95)

# compact letter display
cld_chlor_A <- multcompLetters4(out1[[6]], tukey_chlor_A)

# table with factors and 3rd quantile

dt_chlor_A <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Chlorophyll_A), sd = sd(Chlorophyll_A)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df6 <- data.frame(letters = cld_chlor_A$`Light:Media`$Letters)
dt_chlor_A$cld_chlor_A1 <- cld_df6$letters

#print(dt_chlor_A)

p_chlor_A <- ggplot(dt_chlor_A, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Clorophyl_A concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Chlorophyl_A concentration") +
  geom_text(aes(label = cld_chlor_A1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_chlor_A
```


```{r, echo = FALSE}
# Tukey's test
tukey_chlor_B <- TukeyHSD(out1[[7]], conf.level=0.95)

# compact letter display
cld_chlor_B <- multcompLetters4(out1[[7]], tukey_chlor_B)

# table with factors and 3rd quantile

dt_chlor_B <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Chlorophyll_B), sd = sd(Chlorophyll_B)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df7 <- data.frame(letters = cld_chlor_B$`Light:Media`$Letters)
dt_chlor_B$cld_chlor_B1 <- cld_df6$letters

#print(dt_chlor_B)

p_chlor_B <- ggplot(dt_chlor_B, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Clorophyl_B concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Chlorophyl_B concentration") +
  geom_text(aes(label = cld_chlor_B1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_chlor_B
```



```{r, echo = FALSE}
# Tukey's test
tukey_tot_chlor <- TukeyHSD(out1[[8]], conf.level=0.95)

# compact letter display
cld_tot_chlor <- multcompLetters4(out1[[8]], tukey_tot_chlor)

# table with factors and 3rd quantile

dt_tot_chlor <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Total_Chlorophyll), sd = sd(Total_Chlorophyll)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df8 <- data.frame(letters = cld_tot_chlor$`Light:Media`$Letters)
dt_tot_chlor$cld_tot_chlor1 <- cld_df8$letters

#print(dt_tot_chlor)

p_tot_chlor <- ggplot(dt_tot_chlor, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Total_Chlorophyll concentration under different Light Conditions") +
  labs(x = "Light", y = "Average Total_Chlorophyll concentration") +
  geom_text(aes(label = cld_tot_chlor1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_tot_chlor
```



```{r, echo = FALSE}
# Tukey's test
tukey_la <- TukeyHSD(out1[[9]], conf.level=0.95)

# compact letter display
cld_la <- multcompLetters4(out1[[9]], tukey_la)

# table with factors and 3rd quantile

dt_la <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Leaf_area), sd = sd(Leaf_area)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df9 <- data.frame(letters = cld_la$`Light:Media`$Letters)
dt_la$cld_la1 <- cld_df9$letters

#print(dt_la)

p_la <- ggplot(dt_la, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Leaf_area under different Light Conditions") +
  labs(x = "Light", y = "Average Leaf_area") +
  geom_text(aes(label = cld_la1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_la
```



```{r, echo = FALSE}
# Tukey's test
tukey_plh <- TukeyHSD(out1[[10]], conf.level=0.95)

# compact letter display
cld_plh <- multcompLetters4(out1[[10]], tukey_plh)

# table with factors and 3rd quantile

dt_plh <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Plant_Height), sd = sd(Plant_Height)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df10 <- data.frame(letters = cld_plh$`Light:Media`$Letters)
dt_plh$cld_plh1 <- cld_df10$letters

#print(dt_plh)

p_plh <- ggplot(dt_plh, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Plant_Height under different Light Conditions") +
  labs(x = "Light", y = "Average Plant_Height") +
  geom_text(aes(label = cld_plh1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_plh
```



```{r, echo = FALSE}
# Tukey's test
tukey_pcc <- TukeyHSD(out1[[11]], conf.level=0.95)

# compact letter display
cld_pcc <- multcompLetters4(out1[[11]], tukey_pcc)

# table with factors and 3rd quantile

dt_pcc <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Perc_Canopy_Cover), sd = sd(Perc_Canopy_Cover)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df11 <- data.frame(letters = cld_pcc$`Light:Media`$Letters)
dt_pcc$cld_pcc1 <- cld_df11$letters

#print(dt_pcc)

p_pcc <- ggplot(dt_pcc, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Perc_Canopy_Cover under different Light Conditions") +
  labs(x = "Light", y = "Average Perc_Canopy_Cover") +
  geom_text(aes(label = cld_pcc1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_pcc
```



```{r, echo = FALSE}
# Tukey's test
tukey_y <- TukeyHSD(out1[[12]], conf.level=0.95)

# compact letter display
cld_y <- multcompLetters4(out1[[12]], tukey_y)

# table with factors and 3rd quantile

dt_y <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Yield), sd = sd(Yield)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df12 <- data.frame(letters = cld_y$`Light:Media`$Letters)
dt_y$cld_y1 <- cld_df12$letters

#print(dt_y)

p_y <- ggplot(dt_y, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Yield under different Light Conditions") +
  labs(x = "Light", y = "Average Yield") +
  geom_text(aes(label = cld_y1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_y
```



```{r, echo = FALSE}
# Tukey's test
tukey_dw <- TukeyHSD(out1[[13]], conf.level=0.95)

# compact letter display
cld_dw <- multcompLetters4(out1[[13]], tukey_dw)

# table with factors and 3rd quantile

dt_dw <- df %>% 
    group_by(Media, Light) %>%
    summarise(w=mean(Dry_Weight), sd = sd(Dry_Weight)) %>%
    arrange(desc(w)) %>% 
    ungroup() %>% 
    mutate(Lightname = factor(Light,
                              levels = c("Blue", "Combination", "Red", "White"),
                              ordered = TRUE))


cld_df13 <- data.frame(letters = cld_dw$`Light:Media`$Letters)
dt_dw$cld_dw1 <- cld_df13$letters

#print(dt_dw)

p_dw <- ggplot(dt_dw, aes(x = Lightname, y = w)) + 
  geom_bar(stat = "identity", aes(fill = Lightname), show.legend = FALSE) +
  geom_errorbar(aes(ymin = w - sd, ymax = w + sd), width = 0.2) +
  ggtitle("Average Dry Weight under different Light Conditions") +
  labs(x = "Light", y = "Average Dry Weight") +
  geom_text(aes(label = cld_dw1, y = w + sd), vjust = -0.5) +
  facet_wrap(~Media)

p_dw
```



## Principal Component Analysis (PCA)

```{r}
pca <- prcomp(scale(numdf))
```


```{r, echo = FALSE}
# Contributions of variables to PC2
fvar1 <- fviz_contrib(pca, choice = "var", axes = 1, top = 10)
fvar1
```


```{r, echo = FALSE}
# Contributions of variables to PC2
fvar2 <- fviz_contrib(pca, choice = "var", axes = 2, top = 10)
fvar2
```


```{r}
#Contribution to both dimensions 1 and 2
fvar12 <- fviz_contrib(pca, choice = "var", axes = 1:2, top = 10)
fvar12
```


```{r, echo = FALSE}
# Individual contribution on PC1
f_ind1 <- fviz_contrib(pca, choice = "ind", axes = 1)
f_ind1
```


```{r, echo = FALSE}
# Individual contribution on PC1
f_ind2 <- fviz_contrib(pca, choice = "ind", axes = 2)
f_ind2
```


```{r, echo = FALSE}
pca_biplot <- fviz_pca_biplot(pca, label = "var",repel = TRUE,
                addEllipses=TRUE, ellipse.level=0.95,
                ggtheme = theme_minimal())

pca_biplot
```


```{r, echo = FALSE}
variableplot <- fviz_pca_var(pca, col.var = "contrib",repel = TRUE, 
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             ggtheme = theme_minimal()) # Avoid text overlapping
variableplot
```


```{r, echo = FALSE}
#Clustering based on raw data
pca_biplot <- fviz_pca_biplot(pca, label = "var", habillage=df$Media,
                addEllipses=TRUE, ellipse.level=0.95,repel = TRUE,
                ggtheme = theme_minimal())
pca_biplot
```


```{r, echo = FALSE}
#Clustering based on kmeans custers
set.seed(123)
km.res <- kmeans(scale(numdf), 3)
clust_membership_biplot <- fviz_pca_biplot(pca, label = "var",habillage = km.res$cluster,
                                           addEllipses=TRUE, ellipse.level=0.95,repel = TRUE,
                                           ggtheme = theme_minimal())
clust_membership_biplot
```



```{r, echo = FALSE}
cor <- cor(numdf)
#Step2: fit EFA model using the number of factors (2) identified in step 1
# fit EFA model using maximum likelihood estimation
fit.mle <- fa(cor, nfactors = 2, fm = "ml", max.iter = 100,rotate = "varimax")
# extract factor loading coefficients
Load <- round(fit.mle$loadings, digits = 2)

# display the factor loadings using heatmap
pheatmap(Load, display_numbers = TRUE, cluster_cols = FALSE, angle_col = 0, 
         main = 'Factor loading coefficients', fontsize_number = 10)
```


```{r, echo = FALSE}
suppressWarnings(
  p<-pheatmap(cor,display_numbers = TRUE, main="Pearson Correlation Heatmap"),classes = "warning")

```




```{r, echo = FALSE}
set.seed(123)
km.res <- kmeans(scale(numdf), 3)

cl1 <- df[km.res$cluster==1,]
cl2<- df[km.res$cluster==2,]
cl3<- df[km.res$cluster==3,]

cl_df <- as.data.frame(cbind(df, km.res$cluster))


names(cl_df)[17] <- "Cluster"

myvars <- names(cl_df) %in% c("Light",  "Media",  "Rep","Cluster" ) 
desc <- cl_df[!myvars]
row.names(desc) <- paste0("Sample_",1:36)
cluster <- cl_df$Cluster
class_data <- cbind(as.data.frame(row.names(desc)),as.data.frame(cluster))
class_data <- class_data %>% convert_as_factor(cluster)
matTrans <- scale(desc) 
d <- dist(matTrans)
tupgma <- upgma(d, method="ward.D2")
cl_df <- cl_df %>% convert_as_factor(Light, Media, Rep,Cluster)
unique(cl_df$Cluster)

#cols <- c("red", "blue1", "orange", "darkgreen", "navy", "brown1", "darkmagenta","darkorchid", "maroon4", "deeppink1")

cols <- c("orange", "darkgreen", "navy")# "brown1", "darkmagenta","darkorchid", "maroon4", "deeppink1"

# Adjust the parameters accordingly.
t4 <- ggtree(tupgma, layout="circular", size = 1) 
t4 <- t4 %<+% class_data + 
  geom_text(aes(color = cluster, label = label, angle = angle, 
                hjust = - 0.2, fontface = "bold"), size = 2.6) +
  geom_tippoint(aes(color = cluster), alpha = 0.5, size = 2) +
  scale_color_manual(values = cols) +
  theme(legend.position="right") +
  theme(plot.margin = unit(c(0,0,0,0), "cm")) +
  theme(plot.background = element_rect(fill = 'white', colour = 'white')) +
  theme(panel.background = element_rect(fill = 'white', colour = 'white')) +
  theme(legend.background = element_rect(fill = 'white'),
        legend.title = element_text(size = 8,face = "bold")) + # LEGEND TITLE
  theme(legend.text = element_text(size = 8, face = "bold")) + # LEGEND TEXT
  theme(text = element_text(color = "black", size = 8)) +
  geom_treescale(x = 0.1,y = 0.1, width = 0.1, offset = NULL,
                 color = "white", linesize = 1E-100, fontsize = 1E-100)

suppressWarnings(t4,classes = "warning")
```

```{r, echo = FALSE}
get_lower_tri<-function(cormat){
cormat[upper.tri(cormat)] <- NA
return(cormat)
}
# Get upper triangle of the correlation matrix
get_upper_tri <- function(cormat){
cormat[lower.tri(cormat)]<- NA
return(cormat)
}


cormat <- round(cor,2)

melted_cormat <- melt(cormat)

upper_tri <- get_upper_tri(cormat)
# Melt the correlation matrix
melted_cormat <- melt(upper_tri, na.rm = TRUE)
# Create a ggheatmap
ggheatmap <- ggplot(melted_cormat, aes(Var2, Var1, fill = value))+
geom_tile(color = "white")+
scale_fill_gradient2(low = "blue", high = "red", mid = "white",
midpoint = 0, limit = c(-1,1), space = "Lab",name="Pearson\nCorrelation")+
theme_minimal()+ # minimal theme
theme(axis.text.x = element_text(angle = 45, vjust = 1,
size = 12, hjust = 1))+
coord_fixed()
  # Print the heatmap
#print(ggheatmap)
ggheatmap +
geom_text(aes(Var2, Var1, label = value), color = "black", size = 2) +
theme(
axis.title.x = element_blank(),
axis.title.y = element_blank(),
panel.grid.major = element_blank(),
panel.border = element_blank(),
panel.background = element_blank(),
axis.ticks = element_blank(),
legend.justification = c(1, 0),
legend.position = c(0.6, 0.7),
legend.direction = "horizontal")+
ggtitle("Pearson Correlation half triangle")+
guides(fill = guide_colorbar(barwidth = 7, barheight = 1,
title.position = "top", title.hjust = 0.5))
```


```{r, echo = FALSE}
pairs_plot <- pairs.panels(numdf, gap=0, pch=21, lm=TRUE, stars = TRUE)
pairs_plot
```



```{r, echo = FALSE}
edist<-dist(numdf)
distMat<-as.matrix(edist)
colors<-colorRampPalette(rev(brewer.pal(9, "RdBu")))(255)
p<-pheatmap(distMat, cluster_distance_rows=edist, cluster_distance_cols=edist,col=colors,display_numbers = FALSE, main="Clustering Distance  Heatmap for all Samples")
p
```



```{r, echo = FALSE}
num_cols <- names(df[,5:14])
fac_cols <- names(df[,1:4])

dist <- dist(df[,num_cols] , diag=TRUE)
hc <- hclust(dist)
dhc <- as.dendrogram(hc)
# Actually, each leaf of the tree has several attributes, like the color, the shape..
plot(dhc)
```


```{r, echo = FALSE}
top_row <- plot_grid(variableplot, pca_biplot, labels = c('A', 'B'), label_size = 22)
completepcaplot <- plot_grid(top_row)
completepcaplot
```



```{r, echo = FALSE}
model1 <- aov(Vit_C ~ Light * Media, data = df)
# get (adjusted) means
model_means1 <- emmeans(object = model1, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld1 <- cld(object = model_means1,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld1

p_vit_1 <- ggplot(data = model_means_cld1,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Vit_C (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Vit_C",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_vit_1
```




```{r, echo = FALSE}
model11 <- aov(Vit_C ~ Media * Light, data = df)
# get (adjusted) means
model_means11 <- emmeans(object = model11, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld11 <- cld(object = model_means11,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld11

p_vit_11 <- ggplot(data = model_means_cld11,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Vit_C (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Vit_C",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_vit_11
```




```{r, echo = FALSE}
model2 <- aov(Flavonoid ~ Light * Media, data = df)
# get (adjusted) means
model_means2 <- emmeans(object = model2, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld2 <- cld(object = model_means2,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld2

pflav1 <- ggplot(data = model_means_cld2,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Flavonoid (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Flavonoid",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


pflav1
```




```{r, echo = FALSE}
model21 <- aov(Flavonoid ~ Media * Light, data = df)
# get (adjusted) means
model_means21 <- emmeans(object = model21, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld21 <- cld(object = model_means21,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld21

pflav_21 <- ggplot(data = model_means_cld21,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Flavonoid (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Flavonoid",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


pflav_21
```




```{r, echo = FALSE}
model3 <- aov(Phenols ~ Light * Media, data = df)
# get (adjusted) means
model_means3 <- emmeans(object = model3, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld3 <- cld(object = model_means3,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld3

p_phenol_1 <- ggplot(data = model_means_cld3,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Flavonoid (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Phenols",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_phenol_1
```




```{r, echo = FALSE}
model31 <- aov(Phenols ~ Media * Light, data = df)
# get (adjusted) means
model_means31 <- emmeans(object = model31, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld31 <- cld(object = model_means31,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld31

p_phenol_21 <- ggplot(data = model_means_cld31,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Flavonoid (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Flavonoid",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_phenol_21
```




```{r, echo = FALSE}
model4 <- aov(Nitrate ~ Light * Media, data = df)
# get (adjusted) means
model_means4 <- emmeans(object = model4, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld4 <- cld(object = model_means4,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld4

p_nit_1 <- ggplot(data = model_means_cld4,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Nitrate (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Nitrate",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_nit_1
```




```{r, echo = FALSE}
model41 <- aov(Nitrate ~ Media * Light, data = df)
# get (adjusted) means
model_means41 <- emmeans(object = model41, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld41 <- cld(object = model_means41,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld41

p_nit_41 <- ggplot(data = model_means_cld41,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Nitrate (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Nitrate",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_nit_41
```



```{r, echo = FALSE}
model5 <- aov(Carotenoid ~ Light * Media, data = df)
# get (adjusted) means
model_means5 <- emmeans(object = model5, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld5 <- cld(object = model_means5,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld5

p_car_1 <- ggplot(data = model_means_cld5,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Carotenoid (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Carotenoid",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_car_1
```




```{r, echo = FALSE}
model51 <- aov(Carotenoid ~ Media * Light, data = df)
# get (adjusted) means
model_means51 <- emmeans(object = model51, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld51 <- cld(object = model_means51,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld51

p_car_51 <- ggplot(data = model_means_cld51,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Nitrate (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Nitrate",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_car_51
```




```{r, echo = FALSE}
model6 <- aov(Chlorophyll_A ~ Light * Media, data = df)
# get (adjusted) means
model_means6 <- emmeans(object = model6, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld6 <- cld(object = model_means6,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld6

p_chlor_1 <- ggplot(data = model_means_cld6,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Chlorophyll_A (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Chlorophyll_A",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_chlor_1
```




```{r, echo = FALSE}
model61 <- aov(Chlorophyll_A ~ Media * Light, data = df)
# get (adjusted) means
model_means61 <- emmeans(object = model61, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld61 <- cld(object = model_means61,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld61

p_chlor_61 <- ggplot(data = model_means_cld61,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Chlorophyll_A (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Chlorophyll_A",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_chlor_61
```



```{r, echo = FALSE}
model7 <- aov(Chlorophyll_B ~ Light * Media, data = df)
# get (adjusted) means
model_means7 <- emmeans(object = model7, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld7 <- cld(object = model_means7,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld7

p_chlor_1B <- ggplot(data = model_means_cld7,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Chlorophyll_B (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Chlorophyll_B",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_chlor_1B
```




```{r, echo = FALSE}
model71 <- aov(Chlorophyll_B ~ Media * Light, data = df)
# get (adjusted) means
model_means71 <- emmeans(object = model71, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld71 <- cld(object = model_means71,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld71

p_chlor_71 <- ggplot(data = model_means_cld71,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Chlorophyll_B (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Chlorophyll_B",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_chlor_71
```





```{r, echo = FALSE}
model8 <- aov(Total_Chlorophyll ~ Light * Media, data = df)
# get (adjusted) means
model_means8 <- emmeans(object = model8, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld8 <- cld(object = model_means8,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld8

p_chlor_ab <- ggplot(data = model_means_cld8,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Total_Chlorophyll (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Total_Chlorophyll",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_chlor_ab
```




```{r, echo = FALSE}
model81 <- aov(Total_Chlorophyll ~ Media * Light, data = df)
# get (adjusted) means
model_means81 <- emmeans(object = model81, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld81 <- cld(object = model_means81,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld81

p_chlor_81 <- ggplot(data = model_means_cld81,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Total_Chlorophyll (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Total_Chlorophyll",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_chlor_81
```





```{r, echo = FALSE}
model9 <- aov(Leaf_area ~ Light * Media, data = df)
# get (adjusted) means
model_means9 <- emmeans(object = model9, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld9 <- cld(object = model_means9,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld9

p_la_1 <- ggplot(data = model_means_cld9,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Leaf_area (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Leaf_area",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_la_1
```




```{r, echo = FALSE}
model91 <- aov(Leaf_area ~ Media * Light, data = df)
# get (adjusted) means
model_means91 <- emmeans(object = model91, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld91 <- cld(object = model_means91,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld91

p_la_91 <- ggplot(data = model_means_cld91,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Leaf_area (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Leaf_area",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_la_91
```


```{r, echo = FALSE}
model_10 <- aov(Plant_Height ~ Light * Media, data = df)
# get (adjusted) means
model_means_10 <- emmeans(object = model_10, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld_10 <- cld(object = model_means_10,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_10

p_ph_10 <- ggplot(data = model_means_cld_10,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Plant_Height (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Plant_Height",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_ph_10
```




```{r, echo = FALSE}
model_101 <- aov(Plant_Height ~ Media * Light, data = df)
# get (adjusted) means
model_means_101 <- emmeans(object = model_101, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld_101 <- cld(object = model_means_101,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_101

p_ph_101 <- ggplot(data = model_means_cld_101,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Plant_Height (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Plant_Height",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_ph_101
```






```{r, echo = FALSE}
model_11 <- aov(Perc_Canopy_Cover ~ Light * Media, data = df)
# get (adjusted) means
model_means_11 <- emmeans(object = model_11, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld_11 <- cld(object = model_means_11,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_11

p_pcc_11 <- ggplot(data = model_means_cld_11,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Perc_Canopy_Cover (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Perc_Canopy_Cover",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_pcc_11
```




```{r, echo = FALSE}
model_111 <- aov(Perc_Canopy_Cover ~ Media * Light, data = df)
# get (adjusted) means
model_means_111 <- emmeans(object = model_111, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld_111 <- cld(object = model_means_111,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_111

p_pcc_111 <- ggplot(data = model_means_cld_111,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Perc_Canopy_Cover (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Perc_Canopy_Cover",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_pcc_111
```




```{r, echo = FALSE}
model_12 <- aov(Yield ~ Light * Media, data = df)
# get (adjusted) means
model_means_12 <- emmeans(object = model_12, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld_12 <- cld(object = model_means_12,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_12

p_y_12 <- ggplot(data = model_means_cld_12,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Yield (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Yield",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_y_12
```




```{r, echo = FALSE}
model_112 <- aov(Yield ~ Media * Light, data = df)
# get (adjusted) means
model_means_112 <- emmeans(object = model_112, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld_112 <- cld(object = model_means_112,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_112

p_y_112 <- ggplot(data = model_means_cld_112,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Yield (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Yield",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_y_112
```




```{r, echo = FALSE}
model_13 <- aov(Dry_Weight~ Light * Media, data = df)
# get (adjusted) means
model_means_13 <- emmeans(object = model_13, specs = ~ Light | Media) 
# add letters to each mean
model_means_cld_13 <- cld(object = model_means_13,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_13

p_dw_13 <- ggplot(data = model_means_cld_13,
       aes(x = Light, y = emmean, fill = Light)) +
  facet_grid(cols = vars(Media)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Dry_Weight (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Light") +
  labs(title = "Dry_Weight",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_dw_13
```




```{r, echo = FALSE}
model_113 <- aov(Dry_Weight ~ Media * Light, data = df)
# get (adjusted) means
model_means_113 <- emmeans(object = model_113, specs = ~ Media | Light) 
# add letters to each mean
model_means_cld_113 <- cld(object = model_means_113,
                       adjust = "Tukey",
                       Letters = letters,
                       alpha = 0.05)
# show output
model_means_cld_113

p_dw_113 <- ggplot(data = model_means_cld_113,
       aes(x = Media, y = emmean, fill = Media)) +
  facet_grid(cols = vars(Light)) +
  geom_bar(stat = "identity", color = "black", show.legend = FALSE) +
  geom_errorbar(aes(ymin = emmean - SE, ymax = emmean + SE), width = 0.2) +
  scale_y_continuous(
    name = "Dry_Weight (adj. mean ± 1 std. error)",
    expand = expansion(mult = c(0, 0.1)),
    labels = scales::number_format(accuracy = 0.1)
  ) +
  xlab("Media") +
  labs(title = "Dry_Weight",
       caption = "Separaetly per Media, means followed by a common letter are not significantly different according to the Tukey-test") +
  geom_text(aes(label = str_trim(.group), y = emmean + SE), vjust = -0.5) +
  scale_fill_manual(values = c("midnightblue", "dodgerblue4", "steelblue3", 'lightskyblue')) +
  theme_classic() +
  theme(
    panel.border = element_blank(),
    panel.grid.major = element_blank(),
    panel.background = element_blank(),
    panel.grid.minor = element_blank(),
    axis.line = element_line(),
    axis.text.x = element_text(angle = 90,vjust = -0.01),
    axis.title.x = element_text(vjust = -0.1),
    axis.title.y = element_text(size = 8)
  ) +
  theme(legend.title = element_blank(),
        legend.position = "none")


p_dw_113
```





The file was created using `R` version ``r paste0(version$major, "." ,version$minor)``.
